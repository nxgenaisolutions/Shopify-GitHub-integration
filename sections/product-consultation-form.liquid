<section id="contact" class="footer-cta">
  <div class="container">
    <h2>{{ section.settings.form_heading }}</h2>
    <p>{{ section.settings.form_subheading }}</p>
    
    {% if section.settings.use_simple_button %}
      <a href="{{ section.settings.button_link }}" class="cta-button">
        {{ section.settings.button_text }}
      </a>
    {% else %}
      <div class="consultation-form-wrapper">
        {% form 'contact' %}
          {% if form.posted_successfully? %}
            <div class="form-success">
              <p>âœ“ Thank you! We'll be in touch within 24 hours to schedule your consultation.</p>
            </div>
          {% endif %}

          {% if form.errors %}
            <div class="form-errors">
              <p>Please correct the following:</p>
              <ul>
                {% for field in form.errors %}
                  <li>{{ field | capitalize }} {{ form.errors.messages[field] }}</li>
                {% endfor %}
              </ul>
            </div>
          {% endif %}

          <div class="form-grid">
            <div class="form-field">
              <label for="contact-name">Full Name *</label>
              <input type="text" id="contact-name" name="contact[name]" required>
            </div>

            <div class="form-field">
              <label for="contact-email">Email *</label>
              <input type="email" id="contact-email" name="contact[email]" required>
            </div>

            <div class="form-field">
              <label for="contact-company">Company</label>
              <input type="text" id="contact-company" name="contact[company]">
            </div>

            <div class="form-field">
              <label for="contact-phone">Phone</label>
              <input type="tel" id="contact-phone" name="contact[phone]">
            </div>

            <div class="form-field form-field-full">
              <label for="contact-service">Service Interested In</label>
              <input type="text" id="contact-service" name="contact[service]" value="{{ product.title }}" readonly>
            </div>

            <div class="form-field form-field-full">
              <label for="contact-message">Tell us about your project *</label>
              <textarea id="contact-message" name="contact[body]" rows="5" required></textarea>
            </div>
          </div>

          <button type="submit" class="cta-button">{{ section.settings.submit_button_text }}</button>
        {% endform %}
      </div>
    {% endif %}

    {% if section.settings.show_additional_info %}
      <p style="margin-top: 30px; font-size: 0.9rem;">
        {{ section.settings.additional_info }}
      </p>
    {% endif %}
  </div>
</section>

<style>
  .footer-cta {
    background-color: var(--primary-color);
    color: var(--light-text-color);
    text-align: center;
    padding: 60px 0;
  }
  .footer-cta h2 {
    font-size: 2rem;
    margin-bottom: 20px;
  }
  .consultation-form-wrapper {
    max-width: 700px;
    margin: 30px auto;
    background: white;
    padding: 40px;
    border-radius: 8px;
    text-align: left;
  }
  .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
  }
  .form-field {
    display: flex;
    flex-direction: column;
  }
  .form-field-full {
    grid-column: 1 / -1;
  }
  .form-field label {
    color: var(--text-color);
    font-weight: 600;
    margin-bottom: 8px;
    font-size: 0.95rem;
  }
  .form-field input,
  .form-field textarea {
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-family: 'Poppins', sans-serif;
    font-size: 1rem;
  }
  .form-field input:focus,
  .form-field textarea:focus {
    outline: none;
    border-color: var(--accent-color);
  }
  .form-success {
    background: #d4edda;
    color: #155724;
    padding: 15px;
    border-radius: 4px;
    margin-bottom: 20px;
  }
  .form-errors {
    background: #f8d7da;
    color: #721c24;
    padding: 15px;
    border-radius: 4px;
    margin-bottom: 20px;
  }
  .form-errors ul {
    margin: 10px 0 0 20px;
  }
  @media (max-width: 768px) {
    .form-grid {
      grid-template-columns: 1fr;
    }
    .consultation-form-wrapper {
      padding: 30px 20px;
    }
  }
</style>

{% schema %}
{
  "name": "Product Consultation Form",
  "settings": [
    {
      "type": "text",
      "id": "form_heading",
      "label": "Form Heading",
      "default": "Ready to Get Started?"
    },
    {
      "type": "textarea",
      "id": "form_subheading",
      "label": "Form Subheading",
      "default": "Let's schedule a call to discuss how this solution can transform your organization."
    },
    {
      "type": "checkbox",
      "id": "use_simple_button",
      "label": "Use Simple Button Instead of Form",
      "default": false,
      "info": "Check this to show a button linking to external calendar/contact page"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Book a Consultation"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    },
    {
      "type": "text",
      "id": "submit_button_text",
      "label": "Submit Button Text (for form)",
      "default": "Request Consultation"
    },
    {
      "type": "checkbox",
      "id": "show_additional_info",
      "label": "Show Additional Info",
      "default": false
    },
    {
      "type": "textarea",
      "id": "additional_info",
      "label": "Additional Info Text"
    }
  ],
  "presets": [
    {
      "name": "Product Consultation Form"
    }
  ]
}
{% endschema %}